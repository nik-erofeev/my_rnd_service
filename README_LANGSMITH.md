# ü¶úüõ†Ô∏è –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è LangSmith

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç, –∫–∞–∫ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å LangSmith –≤ –ø—Ä–æ–µ–∫—Ç–µ, –∏ –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ—ë –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è —Ç—Ä–µ–π—Å–∏–Ω–≥–∞, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –æ—Ç–ª–∞–¥–∫–∏ LLM-—Ü–µ–ø–æ—á–µ–∫.

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)
–î–ª—è —Ä–∞–±–æ—Ç—ã LangSmith –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã —Å–ª–µ–¥—É—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ —Ñ–∞–π–ª–µ `.env`:

```bash
# –í–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ —Ç—Ä–µ–π—Å–∏–Ω–≥–∞ (true/false)
LANGCHAIN_TRACING_V2=true

# –í–∞—à API –∫–ª—é—á –æ—Ç LangSmith (https://smith.langchain.com/settings)
LANGCHAIN_API_KEY=lsv2_pt_...

# –ò–º—è –ø—Ä–æ–µ–∫—Ç–∞ –≤ LangSmith (—Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –µ—Å–ª–∏ –Ω–µ—Ç)
LANGCHAIN_PROJECT=my_rnd_service

# –≠–Ω–¥–ø–æ–∏–Ω—Ç (–æ–±—ã—á–Ω–æ –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è)
LANGCHAIN_ENDPOINT=https://api.smith.langchain.com
```

### 2. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ –∫–æ–¥–µ (`app/core/config.py`)
–ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º `pydantic-settings` –¥–ª—è —á—Ç–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏. –ö–ª–∞—Å—Å `SmithLangChainConfig` —Å—á–∏—Ç—ã–≤–∞–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `SMITH__` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `SMITH__API_KEY`), –Ω–æ –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–º SDK –º—ã –¥–µ–ª–∞–µ–º **–ø—Ä–æ–±—Ä–æ—Å** –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤ —Å–∏—Å—Ç–µ–º–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ `os.environ` –≤ –∫–æ–Ω—Ü–µ —Ñ–∞–π–ª–∞ `config.py`.

> **–í–∞–∂–Ω–æ:** SDK LangSmith –∏—â–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–º–µ–Ω–Ω–æ —Å –æ–¥–Ω–∏–º –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏–µ–º (`LANGCHAIN_TRACING_V2`), –ø–æ—ç—Ç–æ–º—É —ç—Ç–æ—Ç –º–æ—Å—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º.

---

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `@traceable`

–û—Å–Ω–æ–≤–Ω–æ–π —Å–ø–æ—Å–æ–± –¥–æ–±–∞–≤–∏—Ç—å —Ç—Ä–µ–π—Å–∏–Ω–≥ –∫ –≤–∞—à–µ–π —Ñ—É–Ω–∫—Ü–∏–∏ ‚Äî –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä `@traceable`.

```python
from langsmith import traceable

@traceable(run_type="chain", name="My Custom Chain")
async def my_function(input_data: str):
    # –í–∞—à –∫–æ–¥
    return "result"
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã `@traceable`

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä—ã |
| :--- | :--- | :--- |
| `run_type` | –¢–∏–ø –∑–∞–ø—É—Å–∫–∞. –í–ª–∏—è–µ—Ç –Ω–∞ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É –∏ –∏–∫–æ–Ω–∫—É –≤ UI. | `"chain"` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é), `"llm"`, `"tool"`, `"retriever"`, `"embedding"` |
| `name` | –ò–º—è —Ç—Ä–µ–π—Å–∞ –≤ —Å–ø–∏—Å–∫–µ. –ï—Å–ª–∏ –Ω–µ –∑–∞–¥–∞–Ω–æ ‚Äî –∏–º—è —Ñ—É–Ω–∫—Ü–∏–∏. | `"Handle Kafka Message"`, `"Search Google"` |
| `tags` | –°–ø–∏—Å–æ–∫ —Ç–µ–≥–æ–≤ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏. | `["prod", "kafka"]` |
| `metadata` | –°–ª–æ–≤–∞—Ä—å —Å –¥–æ–ø. –¥–∞–Ω–Ω—ã–º–∏. | `{"user_id": 123, "version": "1.0"}` |

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

#### 1. –û—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ø–æ—á–∫–∞ (Chain)
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏, –∫–æ—Ç–æ—Ä–∞—è –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —à–∞–≥–æ–≤.

```python
@traceable(run_type="chain", name="Process User Request")
async def process_request(user_id: int, query: str):
    # –õ–æ–≥–∏–∫–∞...
    pass
```

#### 2. –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç (Tool)
–ï—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç —á—ë—Ç–∫—É—é —É—Ç–∏–ª–∏—Ç–∞—Ä–Ω—É—é –∑–∞–¥–∞—á—É (–ø–æ–∏—Å–∫, –∑–∞–ø—Ä–æ—Å –≤ –ë–î, –≤—ã—á–∏—Å–ª–µ–Ω–∏—è).

```python
@traceable(run_type="tool", name="Search Wikipedia")
def search_wiki(query: str):
    return wikipedia.search(query)
```

#### 3. –†–µ—Ç—Ä–∏–≤–µ—Ä (Retriever)
–î–ª—è —Ñ—É–Ω–∫—Ü–∏–π –ø–æ–∏—Å–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (RAG, –≤–µ–∫—Ç–æ—Ä–Ω—ã–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö).

```python
@traceable(run_type="retriever", name="Vector DB Search")
async def retrieve_documents(query: str, k: int = 5):
    return vector_store.similarity_search(query, k=k)
```

#### 4. LLM (–ú–æ–¥–µ–ª—å)
–û–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –µ—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ LangChain –æ–±—ä–µ–∫—Ç—ã (`ChatOpenAI`, `GigaChat`), –Ω–æ –º–æ–∂–Ω–æ –ø–æ–º–µ—Ç–∏—Ç—å –≤—Ä—É—á–Ω—É—é, –µ—Å–ª–∏ –≤—ã –¥–µ–ª–∞–µ—Ç–µ –ø—Ä—è–º–æ–π –∑–∞–ø—Ä–æ—Å –∫ API.

```python
@traceable(run_type="llm", name="GigaChat Direct Call")
async def call_llm_api(prompt: str):
    # requests.post(...)
    pass
```

---

## üêû –û—Ç–ª–∞–¥–∫–∞
–ï—Å–ª–∏ —Ç—Ä–µ–π—Å—ã –Ω–µ –ø–æ—è–≤–ª—è—é—Ç—Å—è:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `.env`: `LANGCHAIN_TRACING_V2=true`.
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤ `.env` –∑–∞–¥–∞–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π `LANGCHAIN_API_KEY`.
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∞—à –∫–æ–¥ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è (—Å–µ—Ä–≤–∏—Å –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è). –¢—Ä–µ–π—Å —Å–æ–∑–¥–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –º–æ–º–µ–Ω—Ç –≤—ã–∑–æ–≤–∞ –¥–µ–∫–æ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏.
